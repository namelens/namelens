# SDR-001: x/crypto and x/net False Positives from openrdap

**Date:** 2026-01-25 **Status:** Approved **Author:** Claude Opus 4.5 (cicd)
**Reviewer:** @3leapsdave

## Context

During v0.1.4 security remediation, grype flagged multiple critical and high
severity vulnerabilities in `golang.org/x/crypto` and `golang.org/x/net`.
Investigation determined these are false positives due to how grype interprets
Go module version requirements from transitive dependencies.

## Findings

| ID                  | Severity | Package         | Reported Version | Fix Version |
| ------------------- | -------- | --------------- | ---------------- | ----------- |
| GHSA-v778-237x-gjrc | Critical | x/crypto        | v0.9.0           | v0.31.0     |
| GHSA-hcg3-q754-cr77 | High     | x/crypto        | v0.9.0           | v0.35.0     |
| GHSA-4374-p667-p6c8 | High     | x/net           | v0.10.0          | v0.17.0     |
| + 8 medium          | Medium   | x/crypto, x/net | v0.9.0, v0.10.0  | various     |

## Analysis

### Root Cause

The SBOM generated by syft includes transitive dependency version requirements,
not just resolved versions. `github.com/openrdap/rdap@v0.9.1` declares minimum
requirements in its `go.mod`:

```bash
$ go mod graph | grep openrdap
github.com/namelens/namelens github.com/openrdap/rdap@v0.9.1
github.com/openrdap/rdap@v0.9.1 golang.org/x/crypto@v0.9.0
```

However, Go's Minimal Version Selection (MVS) algorithm resolves the actual
version used in the build to the highest compatible version across all
requirements.

### Verification

**Declared requirement (from openrdap):**

```bash
$ go mod graph | grep "x/crypto@v0.9"
github.com/openrdap/rdap@v0.9.1 golang.org/x/crypto@v0.9.0
```

**Actual resolved versions:**

```bash
$ go list -m golang.org/x/crypto golang.org/x/net
golang.org/x/crypto v0.47.0
golang.org/x/net v0.48.0
```

**Version comparison:**

| Package  | Required Min | Fix Version | Actual Resolved | Status  |
| -------- | ------------ | ----------- | --------------- | ------- |
| x/crypto | v0.9.0       | v0.31.0     | v0.47.0         | Patched |
| x/net    | v0.10.0      | v0.17.0     | v0.48.0         | Patched |

### Vulnerability Details

The reported vulnerabilities affect various crypto and network functionality.
However, the actual resolved versions (v0.47.0 and v0.48.0) are well beyond the
fix versions and contain all security patches.

**Exploitability in namelens:** None. The runtime uses the resolved versions
which are fully patched.

## Decision

**Classification:** False Positive

**Rationale:**

1. The actual resolved versions (x/crypto v0.47.0, x/net v0.48.0) are patched
2. Go MVS guarantees the highest compatible version is used
3. Grype is incorrectly flagging the minimum version requirement, not the
   resolved version
4. openrdap v0.9.1 is the latest available version; we cannot update it to
   change its requirements

**Options Considered:**

1. **Suppress in allowlist** - Add to `.goneat/dependencies.yaml` with
   documentation
   - Pros: Stops false positive from failing CI, documents decision
   - Cons: Requires maintenance if grype behavior changes

2. **Fork openrdap** - Maintain our own fork with updated requirements
   - Pros: Would eliminate the finding at source
   - Cons: Maintenance burden, unnecessary given resolved versions are safe

3. **Wait for grype/syft fix** - Accept CI noise
   - Pros: No config changes
   - Cons: Noisy reports, unclear to future maintainers

**Chosen:** Option 1 - Suppress with documentation. The false positive is
well-understood and documented.

## Action Items

- [x] Document analysis in SDR
- [x] Update x/crypto and x/net to latest versions
- [ ] Add allowlist entry to `.goneat/dependencies.yaml` if needed
- [ ] Monitor openrdap for new releases
- [ ] Monitor grype/syft for improved Go module handling

## References

- [GHSA-v778-237x-gjrc](https://github.com/advisories/GHSA-v778-237x-gjrc)
- [GHSA-4374-p667-p6c8](https://github.com/advisories/GHSA-4374-p667-p6c8)
- [Go Minimal Version Selection](https://go.dev/ref/mod#minimal-version-selection)
- [openrdap/rdap](https://github.com/openrdap/rdap)
